//-----------------------------------------  ДЛЯ 8ДР ------------------------------------------
// Для різних конфігурацій можливо потрібно буде дещо відкоригувати ці функції
// Дані функції протестовано в конфігурації подібній до FORT2000.

//------ Copyrigtch (c) 2001 SABA  Email: sabatex@mail.uzhgorod.ua ---------------
//------ Використовується, якщо зарплата розраховується в расчете ---------
Функция НарахованоСотр(СотрН,Год,Месяц,ВР) экспорт
	Нараховано = 0;
	МатПомощь=0;
	ПоДоговору =0;
	Сотр = СоздатьОбъект("Справочник.Сотрудники");
	ДТ=Дата(Год,Месяц,1);
	Если Сотр.НайтиПоКоду(СотрН,0)=1 тогда
		ЖрнЗарплата = СоздатьОбъект("ЖурналРасчетов.Зарплата");

	    // Все начисления згідно розрахунків за період 1
   	    ЖрнЗарплата.ВыбратьПериодПоОбъекту(Сотр.ТекущийЭлемент(),ДТ);
		Пока ЖрнЗарплата.ПолучитьЗапись()<>0 Цикл
		    Если ЖрнЗарплата.ВидРасч.ВходитВГруппу(ГруппаРасчетов.ВсеНачисления)<>0 Тогда
				Если (ЖрнЗарплата.ВидРасч=ВидРасчета.МатПомощьНеОблНал) или (ЖрнЗарплата.ВидРасч=ВидРасчета.МатПомощьОблНал) Тогда
		        	МатПомощь=МатПомощь+ЖрнЗарплата.Результат;
				иначеЕсли ЖрнЗарплата.ВидРасч=ВидРасчета.ПоДоговору Тогда
					ПоДоговору = ПоДоговору + ЖрнЗарплата.Результат;
                иначе
                    Нараховано=Нараховано+ЖрнЗарплата.Результат;
    			КонецЕсли;
			КонецЕсли;
		КонецЦикла;
		Возврат(?(ВР=1,Нараховано,?(ВР=2,ПоДоговору,?(ВР=3,МатПомощь,0))));
	иначе
		Возврат(0);
	конецесли;
КонецФункции // НарахованоСотр(Сотр,Месяц,ВР) экспорт

//------ Copyrigtch (c) 2001 SABA  Email: sabatex@mail.uzhgorod.ua ---------------
//------ Використовується, якщо зарплата розраховується в расчете ---------
Функция НарахПодСотр(СотрН,Год,Месяц,ВР) экспорт
	Нараховано = 0;
	МатПомощь=0;
	ПоДоговору =0;
    УтриманоПП =0;
	Сотр = СоздатьОбъект("Справочник.Сотрудники");
	ДТ=Дата(Год,Месяц,1);
	Если Сотр.НайтиПоКоду(СотрН,0)=1 тогда
		ЖрнЗарплата = СоздатьОбъект("ЖурналРасчетов.Зарплата");
	    // Все начисления згідно розрахунків за період 1
   	    ЖрнЗарплата.ВыбратьПериодПоОбъекту(Сотр.ТекущийЭлемент(),ДТ);
		Пока ЖрнЗарплата.ПолучитьЗапись()<>0 Цикл
		    Если ЖрнЗарплата.ВидРасч.ВходитВГруппу(ГруппаРасчетов.ВсеНачисления)<>0 Тогда
				Если (ЖрнЗарплата.ВидРасч=ВидРасчета.МатПомощьНеОблНал) или (ЖрнЗарплата.ВидРасч=ВидРасчета.МатПомощьОблНал) Тогда
		        	МатПомощь=МатПомощь+ЖрнЗарплата.Результат;
				иначеЕсли ЖрнЗарплата.ВидРасч=ВидРасчета.ПоДоговору Тогда
					ПоДоговору = ПоДоговору + ЖрнЗарплата.Результат;
                иначе
                    Нараховано=Нараховано+ЖрнЗарплата.Результат;
				КонецЕсли;
			ИначеЕсли ЖрнЗарплата.ВидРасч=ВидРасчета.ПодоходныйНалог тогда
			    УтриманоПП=УтриманоПП+ЖрнЗарплата.Результат;
			ИначеЕсли ЖрнЗарплата.ВидРасч=ВидРасчета.ПодоходныйНалог_договор тогда
			    УтриманоПП=УтриманоПП+ЖрнЗарплата.Результат;
			КонецЕсли;
		КонецЦикла;
		Если ((ВР=1) и (Нараховано<>0)) или ((ВР=2) и (ПоДоговору<>0)) Тогда
		    Возврат(УтриманоПП);
		иначе
			Возврат(0);
		КонецЕсли;
	иначе
		Возврат(0);
	конецесли;
КонецФункции // НарахованоСотр(Сотр,Месяц,ВР) экспорт

//------ Copyrigtch (c) 2001 SABA  Email: sabatex@mail.uzhgorod.ua ---------------
Функция ИННСотрудника(Номер) экспорт
    Сотр = СоздатьОбъект("Справочник.Сотрудники");
	Если Сотр.НайтиПоКоду(Номер,0)=1 тогда
	    Возврат(СокрЛП(Сотр.ИНН));
	иначе
		Возврат("");
	конецесли;
КонецФункции // ИННСотрудника(Номер)

//------ Copyrigtch (c) 2001 SABA  Email: sabatex@mail.uzhgorod.ua ---------------
Функция ЛьготСотрудника(Номер) экспорт
    Сотр = СоздатьОбъект("Справочник.Сотрудники");
	Если Сотр.НайтиПоКоду(Номер,0)=1 тогда
  		Льгот = 0;
		СпНалЛьготы = СоздатьОбъект("Справочник.НалоговыеЛьготы");
		СпНалЛьготы.ИспользоватьВладельца(Сотр.ТекущийЭлемент());
		СпНалЛьготы.ВыбратьЭлементы();
		Пока СпНалЛьготы.ПолучитьЭлемент()=1 Цикл
            Если Льгот< СпНалЛьготы.Величина Тогда
                Льгот = СпНалЛьготы.Величина;
            КонецЕсли;
		КонецЦикла;

		Если Льгот>=14 Тогда
			Возврат(4);
		ИначеЕсли Льгот>=9 Тогда
			Возврат(3);
		ИначеЕсли Льгот>=4 Тогда
			Возврат(2);
		Иначе
			Возврат(0);
		КонецЕсли;
	иначе
		Возврат(0);
	конецесли;
КонецФункции // ИННСотрудника(Номер)


//------ Copyrigtch (c) 2001 SABA  Email: sabatex@mail.uzhgorod.ua ---------------
Функция ФИОСотрудника(Номер) экспорт
    Сотр = СоздатьОбъект("Справочник.Сотрудники");
	Если Сотр.НайтиПоКоду(Номер,0)=1 тогда
	    Возврат(СокрЛП(Сотр));
	иначе
		Возврат("");
	конецесли;
КонецФункции // ФИОСотрудника(Номер)

//------ Copyrigtch (c) 2001 SABA  Email: sabatex@mail.uzhgorod.ua ---------------
Функция ДатаПриемаСотрудника(Номер) экспорт
    Сотр = СоздатьОбъект("Справочник.Сотрудники");
	Если Сотр.НайтиПоКоду(Номер,0)=1 тогда
	    Возврат(СокрЛП(Сотр.ДатаПриема));
	иначе
		Возврат("");
	конецесли;
КонецФункции // ДатаПриемаСотрудника(Номер)

//------ Copyrigtch (c) 2001 SABA  Email: sabatex@mail.uzhgorod.ua ---------------
Функция ДатаУвольненияСотрудника(Номер) экспорт
    Сотр = СоздатьОбъект("Справочник.Сотрудники");
	Если Сотр.НайтиПоКоду(Номер,0)=1 тогда
	    Возврат(СокрЛП(Сотр.ДатаУвольнения));
	иначе
		Возврат("");
	конецесли;
КонецФункции // ДатаУвольненияСотрудника(Номер)

//------ Copyrigtch (c) 2001 SABA  Email: sabatex@mail.uzhgorod.ua ---------------
//------ Використовується, якщо зарплата розраховується не в расчете ---------
Функция ОборотПоСотрудникуДО(ДНач,ДКон,Номер,Счет1,Счет2) экспорт
    Сотр = СоздатьОбъект("Справочник.Сотрудники");
	Если Сотр.НайтиПоКоду(Номер,0)=1 тогда
		Итоги = СоздатьОбъект("БухгалтерскиеИтоги");
		Итоги.ИспользоватьСубконто(ВидыСубконто.Сотрудники,Сотр);
		Итоги.ВыполнитьЗапрос(ДНач,ДКон,Счет1,Счет2,,2);
	    Возврат(СокрЛП(Итоги.ДО()));
	иначе
		Возврат(0);
	конецесли;
КонецФункции // ОборотПоСотруднику(ДНач,ДКон,Номер,Счет1,Счет2)

//------ Copyrigtch (c) 2001 SABA  Email: sabatex@mail.uzhgorod.ua ---------------
//------ Використовується, якщо зарплата розраховується не в расчете ---------
Функция ОборотПоСотрудникуКО(ДНач,ДКон,Номер,Счет1,Счет2) экспорт
    Сотр = СоздатьОбъект("Справочник.Сотрудники");
	Если Сотр.НайтиПоКоду(Номер,0)=1 тогда
		Итоги = СоздатьОбъект("БухгалтерскиеИтоги");
		Итоги.ИспользоватьСубконто(ВидыСубконто.Сотрудники,Сотр);
		Итоги.ВыполнитьЗапрос(ДНач,ДКон,Счет1,Счет2,,2);
	    Возврат(СокрЛП(Итоги.КО()));
	иначе
		Возврат(0);
	конецесли;
КонецФункции // ОборотПоСотруднику(ДНач,ДКон,Номер,Счет1,Счет2)


